{% extends "dzagurov/base.html" %}
{% load static %}
{% load i18n allauth account %}

{% block title %}{% trans "Password Reset" %}{% endblock title %}

{% block content %}

  <!-- Hero -->
  <section class="ftco-intro img" style="background-image: url({% static 'images/bg_2.jpg' %});">
    <div class="overlay"></div>
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-9 text-center">
          <h2>Сброс пароля</h2>
          <p>Отправьте нам адрес вашей электронной почты, и мы пришлём письмо для сброса пароля.</p>
          <p class="mb-0">
            <a href="#" class="btn btn-white px-4 py-3">Записаться на прием</a>
          </p>
        </div>
      </div>
    </div>
  </section>

  {# Глобальные ошибки формы #}
  {% if form.non_field_errors %}
    <div class="alert alert-danger">{{ form.non_field_errors }}</div>
  {% endif %}
  {% for field in form %}
    {% for err in field.errors %}
      <div class="alert alert-danger">{{ err }}</div>
    {% endfor %}
  {% endfor %}

  {# Сообщения Django messages #}
  {% if messages %}
    {% for m in messages %}
      <div class="alert alert-{{ m.tags }}">{{ m }}</div>
    {% endfor %}
  {% endif %}

  <!-- Breadcrumbs -->
  <section class="blog-banner-area" id="category">
    <div class="container h-100">
      <div class="blog-banner">
        <div class="text-center">
          <nav aria-label="breadcrumb" class="banner-breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="{% url 'index' %}">Домой</a></li>
              <li class="breadcrumb-item active" aria-current="page">Сброс пароля</li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </section>

  <!-- Password Reset Box -->
  <section class="login_box_area section-margin">
    <div class="container">
      <div class="row">
        <div class="col-lg-6">

          <div class="card shadow-sm border-0">
            <div class="card-body p-4">
              <h5 class="card-title mb-3">Сброс пароля</h5>

              {% if user.is_authenticated %}
                <div class="mb-3">
                  {% include "account/snippets/already_logged_in.html" %}
                </div>
              {% endif %}

              <div class="mb-3">
                <p class="mb-0">
                  Укажите e-mail, привязанный к вашему аккаунту. Мы отправим на него ссылку для сброса пароля.
                </p>
              </div>

              <form class="row login_form" method="post" action="{% url 'account_reset_password' %}" novalidate>
                {% csrf_token %}

                {# Поля формы в том же виде, что на login/signup #}
                {% include "includes/form_fields.html" with form=form %}

                {{ redirect_field }}

                <div class="col-md-12 form-group mt-3">
                  <button type="submit" class="btn btn-primary">
                    {% trans 'Reset My Password' %}
                  </button>
                </div>

                <div class="col-md-12 form-group">
                  <p class="mb-0">
                    {% blocktrans %}
                    Пожалуйста, свяжитесь с нами, если у вас возникнут сложности со сбросом пароля.
                    {% endblocktrans %}
                  </p>
                </div>
              </form>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  {# При необходимости — тот же локальный фикс чекбокса, что и на login #}
  <style>
    .login_box_area .login_form input[type="checkbox"] {
      width: 1rem;
      height: 1rem;
      transform: none;
      -webkit-transform: none;
      margin-right: 0.5rem;
      vertical-align: middle;
      display: inline-block;
    }

    .login_box_area .login_form .form-group {
      text-align: left;
    }

    .login_box_area .login_form label {
      display: inline-block;
      margin-bottom: 0.2rem;
    }
  </style>

{% endblock content %}
